<script src="//maps.google.com/maps/api/js?v=3.18&sensor=false&client=&key=&libraries=geometry&language=&hl=&region="></script> 
<script src="//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->

<br />
<div class="booyah-box col-xs-10 col-xs-offset-1">

<!--% if @location.latitude.present? && @location.longitude.present? %-->

  <div style='width: 800px;'>
    <div id="map" style='width: 800px; height: 400px;'></div>
  </div>

  <div id="foo" data-lat="<%= @locations.find(1).latitude%>"</div>
  <div id="foo1" data-long="<%= @locations.find(1).longitude%>"</div>
  <script type="text/javascript">
    
    var lat1 = $("#foo").data("lat");
    var long1 = $("#foo1").data("long");
    //console.log(lat1);
    //console.log(long1);

    var mapStyle = [
    {
        "elementType": "geometry",
        "stylers": [
            {
                "hue": "#ff4400"
            },
            {
                "saturation": -68
            },
            {
                "lightness": -4
            },
            {
                "gamma": 0.72
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "labels.icon"
    },
    {
        "featureType": "landscape.man_made",
        "elementType": "geometry",
        "stylers": [
            {
                "hue": "#0077ff"
            },
            {
                "gamma": 3.1
            }
        ]
    },
    {
        "featureType": "water",
        "stylers": [
            {
                "hue": "#00ccff"
            },
            {
                "gamma": 0.44
            },
            {
                "saturation": -33
            }
        ]
    },
    {
        "featureType": "poi.park",
        "stylers": [
            {
                "hue": "#44ff00"
            },
            {
                "saturation": -23
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "hue": "#007fff"
            },
            {
                "gamma": 0.77
            },
            {
                "saturation": 65
            },
            {
                "lightness": 99
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "labels.text.stroke",
        "stylers": [
            {
                "gamma": 0.11
            },
            {
                "weight": 5.6
            },
            {
                "saturation": 99
            },
            {
                "hue": "#0091ff"
            },
            {
                "lightness": -86
            }
        ]
    },
    {
        "featureType": "transit.line",
        "elementType": "geometry",
        "stylers": [
            {
                "lightness": -48
            },
            {
                "hue": "#ff5e00"
            },
            {
                "gamma": 1.2
            },
            {
                "saturation": -23
            }
        ]
    },
    {
        "featureType": "transit",
        "elementType": "labels.text.stroke",
        "stylers": [
            {
                "saturation": -64
            },
            {
                "hue": "#ff9100"
            },
            {
                "lightness": 16
            },
            {
                "gamma": 0.47
            },
            {
                "weight": 2.7
            }
        ]
    }
];

    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {
      zoom: 15,
      center: new google.maps.LatLng(41.8783968,-87.6171476),
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      styles: mapStyle
    }, internal: {id: 'map'}}, function(){

    var circles = handler.addCircles(
    [{ lat: 41.8783968, lng: -87.6171476, radius: 50 }],
    { strokeColor: '#FF0000'}
    );

    var kmls = handler.addKml(
       // { url: "http://scribblemaps.com/api/maps/8cuvanbqxg/kml" }
       {url: "https://raw.githubusercontent.com/hkawanishi/route-sixty-six/master/app/assets/kml/route66_start.kml"}
      );
    markers = handler.addMarkers(<%=raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.bounds.extendWith(circles);
    handler.fitMapToBounds();
    });
    
  </script>

</div>